<html>
	<head>
		<title>Integrate Word in .NET/ application (VB.NET/C#) </title>
		<Style> BODY, P, TD { font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10pt }
	H2,H3,H4,H5 { color: #ff9900; font-weight: bold; }
	H2 { font-size: 13pt; }
	H3 { font-size: 12pt; }
	H4 { font-size: 10pt; color: black; }
	PRE { BACKGROUND-COLOR: #FBEDBB; FONT-FAMILY: "Courier New", Courier, mono; WHITE-SPACE: pre; }
	CODE { COLOR: #990000; FONT-FAMILY: "Courier New", Courier, mono; }
	</Style>


<script language="JavaScript1.2" src="/menu/menu.js"></script>
<link href="/menu/include_menu.css" rel="stylesheet" type="text/css" />


	</head>
	<body bgcolor="#ffffff" color="#000000">

<table>
<tr border = 0>
<td width='12px' valign=top border=2 > &nbsp;</td>

<td border = 0 valign=top>


		<H2>Integrating Microsoft Word In .NET</H2>
		
		<ul class="download">
			<li>
				<a href="WordInDotNet/WordInDotNet_release.zip">Download demo project - 246 Kb </a>
			<li>
				<a href="WordInDotNet/WordInDotNet_src.zip">Download source - 487 Kb</a></li>
		</ul>
		<p><img src="WordInDotNet/WordInDotNet.jpg" alt="WordInDotNet Image"></p>
		
		
		<h2>Introduction</h2>
		<p>This article will explain how we can&nbsp;use Microsoft Word in your .NET 
			application.&nbsp;&nbsp;This will enable you to use your favorite 
			word-processor within your .NET application.
			<h2>
				Background</h2>
		<p>
		I had been working on migrating or improving different transcription workflow 
		applications (medical and legal) applications in .NET. The biggest problem that 
		the&nbsp;transcriptionists&nbsp;faced while transcribing was that of the 
		editor.&nbsp;All of them used an HTML editor which is&nbsp;a part of the 
		windows-form application.&nbsp;In the period of&nbsp;4-5 years of this 
		application usage, the clients started using MS-Word. Therefore 
		they&nbsp;required that we send Word documents as output, instead of the HTML 
		documents sent till now. The workflow was&nbsp;changed by doing this manually. 
		We wanted to have&nbsp;a Word&nbsp;control similar to the HTML editor that can 
		become a part of the application. Unfortunately, there&nbsp;is no such&nbsp;way 
		to do that.
		<P>
		While searching&nbsp;at Google, I came across the project which shows the trick 
		of making any window the part of your application.
		<P>This article is based on the article posted at <A href="http://www.codeproject.com/cs/miscctrl/winwordcontrol.asp"  target="_blank">
				http://www.codeproject.com/cs/miscctrl/winwordcontrol.asp</A>
		<P>Just when I was writing this article, I found one more article suggesting this 
			trick at: <A href="http://www.codeproject.com/vb/net/ByPassAutomation.asp"  target="_blank">http://www.codeproject.com/vb/net/ByPassAutomation.asp</A>
			<h2>Using the code</h2>
		<p>
			I would highly recommend reading the base-article mentioned in the Background 
			section. It is posted at <A href="http://www.codeproject.com/cs/miscctrl/winwordcontrol.asp"  target="_blank">
				http://www.codeproject.com/cs/miscctrl/winwordcontrol.asp</A>
		<P>
		When we contain a window within our application, we do not want that the window 
		should be allowed to close through its Close (X) button. Similarly, we do not 
		want the Minimize, Maximize and Restore buttons to work.&nbsp;
		<P>One way to solve the problem is to hide the title bar itself. This can be done 
			using the SystemInformation class, as show below</P>
		<pre>
int borderWidth = SystemInformation.Border3DSize.Width;
int borderHeight = SystemInformation.Border3DSize.Height;
int captionHeight = SystemInformation.CaptionHeight;
int statusHeight = SystemInformation.ToolWindowCaptionHeight;

// Move the window in the container so that the container borders hide the window's title bar.
MoveWindow(
	wordWnd, 
	-2*borderWidth,
	-2*borderHeight - captionHeight, 
	this.Bounds.Width + 4*borderWidth, 
	this.Bounds.Height + captionHeight + 4*borderHeight + statusHeight,
	true);
</pre>
		<P>But what would happen if the user presses "Alt+Spacebar"? This will open up the 
			System Menu for the user, where the user can select Restore, Minimize, Close, 
			etc. We don't even want that to happen. We can disable this System Menu using 
			the Windows API. This is shown below.</P>
		<PRE>// We want to remove the system menu also. 
// The title bar is not visible, but we want to avoid 
// accidental minimize, maximize, etc ..by 
// disabling the system menu (Alt+Space) 
int hMenu = GetSystemMenu(wordWnd,false);

if(hMenu&gt;0)	
{ 
  int menuItemCount	= GetMenuItemCount(hMenu); 
  RemoveMenu(hMenu, menuItemCount - 1, MF_REMOVE	| MF_BYPOSITION); 
  RemoveMenu(hMenu, menuItemCount - 2, MF_REMOVE	| MF_BYPOSITION); 
  RemoveMenu(hMenu, menuItemCount - 3, MF_REMOVE	| MF_BYPOSITION); 
  RemoveMenu(hMenu, menuItemCount - 4, MF_REMOVE	| MF_BYPOSITION); 
  RemoveMenu(hMenu, menuItemCount - 5, MF_REMOVE	| MF_BYPOSITION); 
  RemoveMenu(hMenu, menuItemCount - 6, MF_REMOVE	| MF_BYPOSITION); 
  RemoveMenu(hMenu, menuItemCount - 7, MF_REMOVE	| MF_BYPOSITION); 
  RemoveMenu(hMenu, menuItemCount - 8, MF_REMOVE	| MF_BYPOSITION);
  DrawMenuBar(wordWnd);
}
</PRE>
		<P>You may also want to have only some command bars in the MS-Word window. E.g. you 
			may not want the "Menu Bar" (which is also a command bar in MS-Word). This is 
			shown below.</P>
		<PRE>
objWinWordControl.document.ActiveWindow.Application.CommandBars["Menu Bar"].Enabled=false;
</PRE>
		<P>The "Standard" command bar in MS-Word has the "New" and "Open" buttons also. We 
			wanted to disable those buttons also. We did that as shown below</P>
		<PRE>
wd.ActiveWindow.Application.CommandBars["Standard"].Controls[1].Enabled=false;
wd.ActiveWindow.Application.CommandBars["Standard"].Controls[2].Enabled=false;
</PRE>
		<P>In some cases, you will need to have the "Menu Bar", but not all the sub-menu 
			options. You can disable those options by using the CommandBarPopUp class</P>
		<PRE>Office.CommandBarPopup c;
c = (Office.CommandBarPopup)wd.ActiveWindow.Application.CommandBars["Menu Bar"].Controls[0];
c.Controls["Close Window"].Enabled=false;
</PRE>
		<H2>The attached code</H2>
		<P>
		The code attached is&nbsp;part of the&nbsp;larger transcription workflow. It is 
		developed using .NET 1.1 framework and MS-Word 2000.
		<P>
		In most transcription applications, you will have a scenario like 
		"Transcription --&gt; QA1 --&gt; QA2....." In these cases, you will have to 
		give an error-marking facility to the QAs. I have just shown a demo in a very 
		basic manner. Say, when a&nbsp;transcript goes from QA1 to QA2, the errors 
		marked by QA2 should not be shown. Therefore we need to remove the 
		error-marking before displaying the transcript to QA2.
		<P>
		We need to have specific kind of templates for different clients of 
		the&nbsp;transcription division. These&nbsp;templates can&nbsp;be 
		pre-configured and used to create new documents (through 
		the&nbsp;"LoadDocument" method). An&nbsp;example of this is shown through the 
		"Load Document" button.
		<P>
		In most cases, you will require that the part of the document being transcribe 
		is automatically filled up. E.g. the Client's ID, Current Date, Record Number, 
		etc. This kind of information will come from the database, therefore must be 
		automatically filled up. I have accomplished this using "Bookmarks" in the word 
		document. A sample can be seen using the "Sample.dot" file.
		<P>You can do much more than what is shown in the attached code.&nbsp;Please find 
			more about Microsoft Word Automation and Windows APIs at MSDN.
			<H2>Enhancements</H2>
		<P>While this application just integrates (contains)&nbsp;MS-Word in .NET 
			application, it was quite interesting to do so with other applications also. We 
			did that with an audio player and found that the concept of containing windows 
			was really useful the second time too.
		</P>
		<P>
			Please feel free to send me your suggestions</P>
		<P></P>
		<PRE>Author:      Anup Shinde
Environment: .NET 1.1,&nbsp;C#, Word 2000 (or higher)
Description: This article explains how you can integrate Microsoft Word in your .NET application</PRE>
		<P>
			</P>

</td>


<td border = 0  valign=top>

<script type="text/javascript"><!--
google_ad_client = "pub-7512590957470103";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel ="";
google_color_border = "FDEFD2";
google_color_bg = "FDEFD2";
google_color_link = "0000CC";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


</td>



</tr>
</table>

<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-665946-1";
urchinTracker();
</script>


	</body>
</html>
